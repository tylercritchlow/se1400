<!DOCTYPE html>
<html lang="en">

<head>
    <title>Milestone 4</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="grid-container">
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a class="active" href="create-1.html">Create</a></li>
            </ul>
        </nav>

        <div class="create-content-2">
            <h1>Final Review</h1>

            <div class="review-container">
                <div class="shirt-preview">
                    <h3>Front</h3>
                    <svg class="shirt" width="300" height="300" viewBox="0 0 174 174" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path id="frontPath"
                            d="M32.625 10.875H65.25L87 32.625L108.75 10.875H141.375H174V54.375L141.375 65.25V174H32.625V65.25L0 54.375V10.875H32.625Z"
                            fill="black" stroke="black" stroke-width="2" />
                        <g id="frontImage"></g>
                    </svg>
                </div>

                <div class="shirt-preview">
                    <h3>Back</h3>
                    <svg class="shirt" width="300" height="300" viewBox="0 0 174 174" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path id="backPath"
                            d="M32.625 10.875H65.25H87H108.75H141.375H174V54.375L141.375 65.25V174H32.625V65.25L0 54.375V10.875H32.625Z"
                            fill="black" stroke="black" stroke-width="2" />
                        <g id="backImage"></g>
                    </svg>
                </div>
            </div>

            <div class="progress-container">
                <div class="step dot"></div>
                <div class="line"></div>
                <div class="step dot"></div>
                <div class="line"></div>
                <div class="step dot"></div>
                <div class="line"></div>
                <div class="step active-step">4</div>
            </div>

            <div class="back-next-btns">
                <a href="create-3.html" class="btn">Back</a>
                <a href="index.html" class="btn" id="completeBtn">Complete</a>
            </div>
        </div>
    </div>
<script>
    const selectedColor = localStorage.getItem('shirtColor') || 'black';
    document.getElementById('frontPath').setAttribute('fill', selectedColor);
    document.getElementById('backPath').setAttribute('fill', selectedColor);

    const frontImageData = localStorage.getItem('frontImage');
    if (frontImageData) {
        const frontImg = document.createElementNS('http://www.w3.org/2000/svg', 'image');
        frontImg.setAttribute('href', frontImageData);
        frontImg.setAttribute('x', '45');
        frontImg.setAttribute('y', '45');
        frontImg.setAttribute('width', '84');
        frontImg.setAttribute('height', '84');
        frontImg.setAttribute('preserveAspectRatio', 'xMidYMid meet');
        document.getElementById('frontImage').appendChild(frontImg);
    }

    const backImageData = localStorage.getItem('backImage');
    if (backImageData) {
        const backImg = document.createElementNS('http://www.w3.org/2000/svg', 'image');
        backImg.setAttribute('href', backImageData);
        backImg.setAttribute('x', '45');
        backImg.setAttribute('y', '45');
        backImg.setAttribute('width', '84');
        backImg.setAttribute('height', '84');
        backImg.setAttribute('preserveAspectRatio', 'xMidYMid meet');
        document.getElementById('backImage').appendChild(backImg);
    }

    document.getElementById('completeBtn').addEventListener('click', function (e) {
        e.preventDefault();

        const frontImage = localStorage.getItem('frontImage');
        const backImage = localStorage.getItem('backImage');
        const color = localStorage.getItem('shirtColor');

        if (frontImage || backImage || color) {
            const designs = JSON.parse(localStorage.getItem('tshirtDesigns') || '[]');
            designs.push({
                frontImage: frontImage,
                backImage: backImage,
                color: color || 'black',
                createdAt: new Date().toISOString()
            });
            localStorage.setItem('tshirtDesigns', JSON.stringify(designs));

            localStorage.removeItem('frontImage');
            localStorage.removeItem('backImage');
            localStorage.removeItem('shirtColor');
        }

        window.location.href = 'index.html';
    });
</script>
</body>

</html>